<html><head></head><body>
<h1>Working with attachments</h1>
The attachments of a message can be split into to categories: <br>
<ul>
<li>Usual file attachments, accessed through <span class="codeInline">Message.Attachments</span>
</li><li>Inline attachments, such as built-in images, accessed through <span class="codeInline">
Message.EmbeddedResources</span></li></ul>
<h2>Downloading attachments</h2>
By default, the library will not download the attachments automatically (unless you
<a href="https://imapx.codeplex.com/wikipage?title=Working%20with%20messages&referringTitle=Working%20with%20attachments">
configure the client to do this</a>). To download an attachment manually, do the following:<br>
<br>
<div style="color:Black; background-color:White">
<pre>
<span style="color:Green">/* .. Init client, authenticate .. */</span>        
<span style="color:Green">/* .. folder = any folder .. */</span>  
<span style="color:Green">/* .. message = any message .. */</span>  

<span style="color:Blue">var</span> folderPath = <span style="color:#A31515">@&quot;C:\attachments&quot;</span>;

<span style="color:Blue">foreach</span> (<span style="color:Blue">var</span> file <span style="color:Blue">in</span> message.Attachments)
{
      file.Download(); <span style="color:Green">// Downloading the attachment</span>
}

</pre>
</div>
<h2>Getting attachment data and saving files to disk</h2>
<div style="color:Black; background-color:White">
<pre>
<span style="color:Green">/* .. Init client, authenticate .. */</span>        
<span style="color:Green">/* .. folder = any folder .. */</span>  
<span style="color:Green">/* .. message = any message .. */</span>  

<span style="color:Blue">var</span> folderPath = <span style="color:#A31515">@&quot;C:\attachments&quot;</span>;

<span style="color:Blue">foreach</span> (<span style="color:Blue">var</span> file <span style="color:Blue">in</span> message.Attachments)
{
      file.Download(); <span style="color:Green">// Downloading the attachment</span>

      <span style="color:Green">/*
            After downloading the attachment you can access its data
            through the FileData property.
      */</span>     

      <span style="color:Green">/*
            To save the file directly to disk, use the Save method.
      */</span>     

      file.Save(folderPath <span style="color:Green">/*, optional file name*/</span>);
}

</pre>
</div>
<br>
<h2>Next</h2>
<ul>
<li><a href="wikipage (15).html">Copying messages</a>
</li><li><a href="wikipage (16).html">Moving messages</a>
</li><li><a href="wikipage (17).html">Removing messages</a>
</li><li><a href="wikipage (18).html">Working with message flags</a>
<ul>
<li><a href="https://imapx.codeplex.com/wikipage?title=%28Un%29Marking%20the%20message%20as%20read%20%28seen%29&referringTitle=Working%20with%20attachments">&#40;Un&#41;Marking the message as read &#40;seen&#41;</a>
</li><li><a href="https://imapx.codeplex.com/wikipage?title=Adding%2fremoving%20message%20flags&referringTitle=Working%20with%20attachments">Adding&#47;removing message flags</a></li></ul>
</li><li><a href="wikipage (21).html">Creating messages</a>
</li><li><a href="wikipage (22).html">Exporting messages</a>
</li><li><a href="wikipage (23).html">Idle support</a></li></ul>
</body></html>